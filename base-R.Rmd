# בסיס השפה (Base R) {#base-r}

בפרק זה נלמד את הבסיס של R, בעיקר נכיר את הפקודות הבסיסיות, אופרטורים (תנאים לוגיים) שונים, התניות, לולאות, סוגי משתנים ובניית פונקציות. בסיס זה נקרא הרבה פעמים גם Base R משום שהוא אינו מכיל חבילות הרחבה כלשהן, ומגיע עם התקנה חדשה של R.

כדי לתרגל את הפקודות שתלמדו בפרק זה (ובפרקים הבאים) מומלץ לפתוח חלון של RStudio ולנסות את הפקודות השונות תוך כדי שאתם קוראים את הפרק.

## השמת משתנים, פעולות אריתמטיות ופונקציות

ניתן להריץ ב-R פעולות אריתמטיות (חיבור, חיסור, כפל, חילוק), פונקציות, ולהגדיר משתנים שונים. לדוגמה, הקוד הבא מגדיר משתנה `a` משתנה `b` ומכניס את הסכום שלהם למשתנה חדש שיקרא `a_plus_b`.

```{r sumab}
a <- 5
b <- 3
a_plus_b <- a + b
a_plus_b
```

שימו לב שההשמה לתוך משתנה מתבצעת עם האופרטור `->`, ניתן גם להשתמש ב`=` לצורך השמה, כתיב זה פחות נפוץ. לדוגמה:

```{r}
a_plus_b = a + b  # this form of assignment `=` is less common, don't use it (use `<-`)
```

### קביעת שמות משתנים

קודם השתמשנו בשמות `a`, `b` , ו-`a_plus_b` כדי לקבוע משתנים. ככלל, מומלץ להשתמש בשמות קצרים בעלי משמעות. שמות משתנים חייבים להתחיל באות באנגלית, ויכולים להכיל אותיות, מספרים, קו תחתון, ונקודה. לדוגמה `gender`, `age`, `raw_data`, וכו'.

### סוגי משתנים

בבסיס השפה יש כמה סוגי משתנים, שקובעים מה סוג הערכים שהמשתנה יכול לקבל:

-   מספר שלם (Integer)

-   מספר רציף (Double)

-   מחרוזת (Character)

-   משתנה קטגוריות (Factor)

-   תאריך (Date)

-   משתנה לוגי (Logical)

כל משתנה חדש אנחנו מגדירים ב-R הוא למעשה וקטור. אגב, גם כשאנחנו מגדירים משתנה כערך בודד, בעצם הוא וקטור עם איבר אחד. אנחנו יכולים להשתמש בפקודה `c` (קיצור של המילה combine) כדי לשלב וקטורים שונים.

נראה דוגמאות להגדרות של וקטורים מסוגים שונים.

```{r variable definition examples}
some_integer <- c(1L, 2L, 3L)  # The L sign stands for "Long integer"
some_integer

some_double <- c(1, 2, pi, exp(1))
some_double

some_character <- c("This", "is", "a", "character", "vector")
some_character

some_factor <- factor(c("Apples", "Oranges", "Paers", "Mangos", "Apples", "Oranges"))
some_factor

some_date <- c(Sys.Date(), as.Date("1993-08-01"))
some_date

some_logical <- c(TRUE, FALSE, FALSE, TRUE) # can also use c(T, F, F, T) is the same
some_logical
```

למשתני קטגוריות יש שימוש חשוב בסטטיסטיקה שעוד נראה אותו בפרקים הבאים, ולכן הוא מובחן ממשתנה מחרוזת ומקבל מקום של כבוד. כפי שניתן לראות, כאשר מדפיסים אותו, R מדווח גם על הרמות השונות שכלולות בו.

שימוש בפקודה `typeof(some_variable)` יציג את סוג המשתנה.

```{r using typeof}
typeof(some_integer)
typeof(some_double)
typeof(some_character)
typeof(some_date)
typeof(some_factor)
typeof(some_logical)
```

ניתן לשים לב ש-R מחשיב את המשתנה הקטגוריאלי כמספר שלם (integer) ואת התאריך כמספר רציף (double).

```{block, type="question"}
באמצעות הפקודה c והפקודה typeof בדקו מה קורה כאשר מחברים משתנים מסוגים שונים אחד לשני.
האם התוצאה הגיונית? מה ההיגיון? האם יש מקרים בהם התוצאה של חיבור משתנים עשויה להטעות?

בדקו את `c(some_factor, some_character)` ודוגמאות נוספות.
```

### קריאה לתתי וקטורים

ב-R ניתן לקרוא לחלק מסוים מתוך וקטור. לדוגמה, אם אנחנו רוצים רק את שני האיברים הראשונים מתוך הוקטור some\_factor או את האיבר הראשון והרביעי מתוך some\_character נשתמש בכתיב:

```{r subsetting vectors}
some_factor[1:2]
some_character[c(1,4)]
```

## רשימה (list)

כעת נדון במבנה נתונים שנקרא רשימה (list). רשימה היא אובייקט מרכזי ב-R שמאפשר לנו לאחד משתנים ווקטורים מסוגים שונים, לתוך dataset שיאפשר לנו בהמשך לנתח נתונים. ישנן מספר דרכים להגדיר רשימה, אחת מהן באמצעות הפקודה `list`. לדוגמה, הרשימה הבאה תכיל את כל הוקטורים שהגדרנו עד כה, מבלי שהם יאבדו מהמשמעות שלהם (כפי שקורה כשמנסים לעשות חיבור רגיל).

```{r a complete list example}
my_list <- list(my_int = some_integer,
                my_double = some_double,
                my_character = some_character,
                my_factor = some_factor,
                my_date = some_date)
my_list
typeof(my_list)

```

כדי לקרוא לוקטור מסוים מתוך רשימה ניתן להשתמש ב-\$ באופן הבא:

```{r select out of a list}
my_list$my_int
```

החלק הסופי בהצגה שלנו הוא רשימה מסוג מאוד מסוים, data.frame. מבנה נתונים זה הוא רשימה שבה כל הוקטורים באותו האורך. הוקטורים יכולים להיות מסוגים שונים כפי שציינו, ומה שחשוב ב-data.frame הוא שהוא הולך להיות אבן הפינה שלנו בכל ניתוח נתונים סטטיסטי. בינתיים נסתפק בהדגמה קצרה של הגדרת data.frame אך נרחיב עליו בפרקים הבאים.

```{r data frame demonstration}
my_data <- data.frame(name = c("Danny", "Moshe", "Iris", "Ronit"),
                      favorite_fruit = factor(c("Mango", "Apple", "Apple", "Paer")),
                      age = c(25L, 32L, 22L, 30L),
                      height = c(1.8, 1.75, 1.6, 1.68),
                      married = c(F, T, F, T))
my_data
typeof(my_data)
```

## שימוש בפונקציות

ניתן גם להפעיל פונקציות שונות, לדוגמה לוגריתם, פונקציות טריגונומטריות. למעשה בסעיף הקודם כבר ראינו מספר פונקציות כגון `c` ו-`typeof`. כעת נראה עוד מספר דוגמאות.

נסו להריץ את הקוד הבא, ולאחר מכן לענות על השאלות שמתחת למקטע הקוד. יש לשים לב שעל מנת להריץ את הפקודות בסוף המקטע (שקשורות ב-`my_data` נדרש קודם להגדיר את `my_data` כפי שהוגדר במקטע הקוד הקודם.

```{r functions-example, eval=FALSE}
log(100)  # natural logarithm
log10(100)  # base 10 logarithm 
sin(pi)  # sin(pi) is 0 but may give you a surprising answer, why?
sqrt(4)  # square root of 4
mean(my_data$age)
sd(my_data$age)
summary(my_data)
```

```{block, type="question"}
שאלה למחשבה: בחלק מהמחשבים התשובה שמתקבלת ל-$\sin(\pi)$ שונה מ-0. למה לדעתך?
```

```{block, type="question"}
הפקודה האחרונה שהרצנו בדוגמה היא פקודת summary.
מה עושה הפקודה summary עבור כל סוג עמודה שהיא מוצאת בdata.frame?
```

ככלל, הפעלת פונקציה ב-R תיראה כך:

```{r, eval=FALSE}
# some code which defines the variable `bar` and then
some_result <- some_function(foo = bar)

# or simply
some_result <- some_function(bar)
```

כאשר `some_result` יחזיק את התוצאה של הפונקציה. הפונקציה עצמה נקראת `some_function`, היא מקבלת ארגומנט (משתנה) יחיד שנקרא `foo` ואנחנו משתמשים במשתנה שערכו `bar` שנכנס לארגומנט.

כדי להמחיש נראה דוגמה נוספת, הפעם עם פונקציה פשוטה שגם נגדיר בעצמנו. נסו לעיין בקוד ולהבין מה המשמעות של כל שורה בקוד. שלושת השורות הראשונות בקוד מגדירות פונקציה חדשה, וההמשך מריץ אותה.

```{r new_function_def}
# define a new function which adds a number
one_plus <- function(number){
  number + 1
}
# use the function:
one_plus(1)
one_plus(one_plus(1))
```

## התניות

123

## לולאות

123
